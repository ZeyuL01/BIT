
<!-- README.md is generated from README.Rmd. Please edit that file -->

![BIMTR](inst/BIMTR.png)

<!-- badges: start -->
<!-- badges: end -->

The goal of **BIMTR** is to identify the potential master
transcriptional regulators with the input derived from chromatin
accessibility profiling methods(e.g. ATAC-seq, DNase-seq, MNase-seq),
the input can be either a file that stores the information of “peaks”
generated by common peak-calling algorithms (e.g. MACS2, Homer) or
user-defined regions, such as peaks from a differential accessibility
analysis(e.g. DiffBind).

## Installation

You can install the development version of BIMTR from
[GitHub](https://github.com/ZeyuL01/BIMTR) with:

``` r
# install.packages("devtools")
#devtools::install_github("ZeyuL01/BIMTR")
#library(BIMTR)
devtools::load_all()
#> ℹ Loading BIMTR
```

If you meet a compilation problem,

for mac users please refer to:
<https://thecoatlessprofessor.com/programming/cpp/r-compiler-tools-for-rcpp-on-macos/>

for windows users please refer to:
<https://cran.r-project.org/bin/windows/base/howto-R-devel.html>

or submit your questions, we are happy to answer them.

## Load ChIP-seq data

Pre-compiled ChIP-seq database can be accessed through:
<https://smu.box.com/s/mhpelp5zro7538pbfkfj65xf61842huo>

``` r
#Please download the chip-seq file and unzip it to a local directory.
#For example: /Users/user/Desktop/data/ChIP-seq

#The function below just need to run once to setup.
#bin_width has to map with the loaded chip-seq file, we have three options: 100/500/1000.
chip_path = "/Users/zeyulu/Dropbox/datasets/macs2_peak_inds_1000_version3/"
load_chip_data(chip_path, bin_width = 1000)
#> Warning in load_chip_data(chip_path, bin_width = 1000): Overwriting previous
#> loaded meta-table for bin width of 1000
#> [1] "ChIP-seq data successfully loaded, please run BIMTR with input to check!"
#> NULL
```

## How to run BIMTR.

It is very simple to run **BIMTR** as long as you have the peak file
derived from a common peak-calling algorithm, or any interested regions
you have defined in advance. The input file should has format of
bed/narrowPeak/broadPeak/bigNarrowPeak.

``` r
#As an example, the user-input peak set file path is "/Users/user/Desktop/input.bed"
input_path = "/Users/zeyulu/Dropbox/datasets/DiffBind_new/CTCF.bed"
input_test<-BIMTR(input_path,format = "bed", N = 5000, bin_width = 1000)
#> [1] "Load and map peaks to bins..."
#> [1] "Done."
#> [1] "Align the loaded peaks with the pre-compiled reference ChIP-seq data, bin width used: 1000 bps"
#> ==================================================[1] "Done."
#> [1] "Start BIMTR Gibbs sampler, iterations: 5000"
#> [1] "Done."
input_results<-Show_Results(input_test, burnin=3000)

head(input_results[["Theta_i"]],10)
#>         TF   Theta_i Rank_i
#> 1    STAG1 -1.991754      1
#> 2     CTCF -2.010570      2
#> 3    RAD21 -2.028572      3
#> 4     SMC3 -2.110285      4
#> 5    STAG2 -2.137083      5
#> 6    SMC1A -2.181428      6
#> 7     PHF2 -2.215959      7
#> 8   INTS12 -2.236738      8
#> 9  HNRNPLL -2.263226      9
#> 10     ME3 -2.274461     10
```
