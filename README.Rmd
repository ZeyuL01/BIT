---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

![BIMTR](inst/BIMTR.png)

<!-- badges: start -->

<!-- badges: end -->

The goal of **BIMTR** is to identify the potential master transcriptional regulators with the input derived from chromatin accessibility profiling methods(e.g. ATAC-seq, DNase-seq, MNase-seq), the input can be either a file that stores the information of "peaks" generated by common peak-calling algorithms (e.g. MACS2, Homer) or user-defined regions, such as peaks from a differential accessibility analysis(e.g. DiffBind).

## Installation

You can install the development version of BIMTR from [GitHub](https://github.com/ZeyuL01/BIMTR) with:

```{r,results='hide'}
# install.packages("devtools")
#devtools::install_github("ZeyuL01/BIMTR")
#library(BIMTR)
devtools::load_all()
```

If you meet a compilation problem,

for mac users please refer to: https://thecoatlessprofessor.com/programming/cpp/r-compiler-tools-for-rcpp-on-macos/

for windows users please refer to: https://cran.r-project.org/bin/windows/base/howto-R-devel.html

or submit your questions, we are happy to answer them.

## Load ChIP-seq data

Pre-compiled ChIP-seq database can be accessed through: https://smu.box.com/s/mhpelp5zro7538pbfkfj65xf61842huo

```{r}
#Please download the chip-seq file and unzip it to a local directory.
#For example: /Users/user/Desktop/data/ChIP-seq

#The function below just need to run once to setup.
#bin_width has to map with the loaded chip-seq file, we have three options: 100/500/1000.
chip_path = "/Users/zeyulu/Dropbox/datasets/macs2_peak_inds_1000_version3/"
load_chip_data(chip_path, bin_width = 1000)
```

## How to run BIMTR.
It is very simple to run **BIMTR** as long as you have the peak file derived from a common peak-calling algorithm, or any interested regions you have defined in advance. The input file should has format of bed/narrowPeak/broadPeak/bigNarrowPeak.

```{r}
#As an example, the user-input peak set file path is "/Users/user/Desktop/input.bed"
input_path = "/Users/zeyulu/Dropbox/datasets/DiffBind_new/CTCF.bed"
input_test<-BIMTR(input_path,format = "bed", N = 5000, bin_width = 1000)
input_results<-Show_Results(input_test, burnin=3000)

head(input_results[["Theta_i"]],10)
```

