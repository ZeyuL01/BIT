---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# BayesIMTR

<!-- badges: start -->

<!-- badges: end -->

The goal of **BayesIMTR** is to identify the potential master transcriptional regulators with the input derived from chromatin accessibility profiling methods(e.g. ATAC-seq, DNase-seq, MNase-seq), the input can be either a file that stores the information of "peaks" generated by common peak-calling algorithms (e.g. MACS2, Homer) or user-defined regions, such as peaks from a differential accessibility analysis(e.g. DiffBind).

## Installation

You can install the development version of BayesIMTR from [GitHub](https://github.com/ZeyuL01/BayesIMTR) with:

```{r,results='hide'}
# install.packages("devtools")
# devtools::install_github("ZeyuL01/BayesIMTR")
library(BayesIMTR)
```

If you meet a compilation problem,

for mac users please refer to: https://thecoatlessprofessor.com/programming/cpp/r-compiler-tools-for-rcpp-on-macos/

for windows users please refer to: https://cran.r-project.org/bin/windows/base/howto-R-devel.html

or submit your questions, we are happy to answer them.

## Load ChIP-seq data

Pre-compiled ChIP-seq database can be accessed through: https://smu.box.com/s/mhpelp5zro7538pbfkfj65xf61842huo

```{r}
#Please download the chip-seq file and unzip it to a local directory.
#For example: /Users/user/Desktop/data/ChIP-seq

#The function below just need to run once to setup.
#bin_width has to map with the loaded chip-seq file, we have three options: 100/500/1000.
chip_path = "/Users/user/Desktop/data/ChIP-seqs"
load_chip_data(chip_path, bin_width = 1000)
```

## How to run BayesIMTR.
It is very simple to run **BayesIMTR** as long as you have the peak file derived from a common peak-calling algorithm, or any interested regions you have defined in advance. The input file should has format of bed/narrowPeak/broadPeak/bigNarrowPeak.

```{r}
#As an example, the user-input peak set file path is "/Users/user/Desktop/input.bed"
input_path = "/Users/user/Desktop/input.bed"
input_test<-BayesIMTR(input_path,format = "bed", N = 1000, bin_width = 1000)
input_results<-Show_Results(input_test, burnin=500)

head(input_results[["Theta_ij"]],10)
head(input_results[["Theta_i"]],10)
```

## Example

This is a basic example which shows you how to get the Demo results used in **BayesIMTR** manuscript:

```{r}
library(BayesIMTR)
library(kableExtra)

##package has three demo knock-out experiment derived datasets c("CTCF","KDM1A","ZBTB7A").
##can take ~10 mins to finish for 1000 rounds.
CTCF_Demo_mat <- Demo(1000,"CTCF")

##Show_Results can summarize the results from Gibbs sampler.
##must specify the burnin.
CTCF_Results <- Show_Results(CTCF_Demo_mat,burnin=500)
CTCF_Theta_ij_db <- CTCF_Results[["Theta_ij"]]
CTCF_Theta_i_db <- CTCF_Results[["Theta_i"]]

head(CTCF_Theta_ij_db,10)
```

As we can see, CTCF is ranked into the top 10 TF in the final result.

We may also check the higher level parameters that integrate information from individual ChIP-seq tracks to give one unique rank to each TF.

```{r}
head(CTCF_Theta_i_db,10)
```

This time CTCF is ranked even higher to the top 1 position over all 1476 TFs.

